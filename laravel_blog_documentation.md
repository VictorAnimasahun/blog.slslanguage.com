# SLS Blog Subdomain - Architecture Documentation

## Overview

This document describes the structure and relationships of the Laravel blog application running on the `blog.slslanguage.com` subdomain. The blog is a separate installation from the main `slslanguage.com` website, allowing for independent maintenance and scaling.

## Directory Structure

### Root Level
The application lives in `/home/slslanguage/blog.slslanguage.com/` on the cPanel server.

### Key Folders

**`/app`** — Contains the core application logic
- **`/Models`** — PHP classes representing database tables as objects (User, Post, Category, Comment)
- **`/Http/Controllers`** — Classes that handle incoming requests and return responses (BlogController processes blog page requests)

**`/database`** — Manages database structure and data
- **`/migrations`** — Files that define how to create and modify database tables (run once, tracked by Laravel)
- **`/seeders`** — Optional files for populating test data into the database

**`/resources/views`** — Contains all HTML templates (Blade files)
- **`/layouts`** — Master templates that other pages extend (app.blade.php is the main layout with header, nav, footer)
- **`/blog`** — Specific blog page templates (index.blade.php for homepage, show.blade.php for individual posts, category.blade.php for category pages)

**`/routes`** — Defines URL paths and what happens when users visit them
- **`web.php`** — Maps URLs to controllers (e.g., `/blog/{slug}` routes to BlogController's show method)

**`/config`** — Configuration files for the application
- **`app.php`** — Application settings and service providers
- **`database.php`** — Database connection settings

**`/bootstrap`** — Files that set up the Laravel application before it runs

**`/public`** — The only folder accessible from the web
- **`index.php`** — Entry point for all requests (server directs all traffic here)
- Contains compiled assets like CSS and JavaScript

**`/storage`** — Temporary files and logs
- **`/framework`** — Cache, sessions, and compiled views
- **`logs`** — Error and application logs

**`/vendor`** — Third-party packages installed via Composer (do not edit)

## How Requests Flow Through the Application

### 1. User visits the blog
User opens `https://blog.slslanguage.com` in their browser.

### 2. Server routes to public folder
The cPanel subdomain points its Document Root to `/home/slslanguage/blog.slslanguage.com/public`, so the server serves `public/index.php`.

### 3. Laravel bootstraps
`public/index.php` loads `bootstrap/app.php`, which initializes the Laravel framework and loads configuration from `/config` files.

### 4. Router matches the URL
`routes/web.php` examines the requested URL and determines which controller method should handle it. For example, visiting `/` matches the `index` method of `BlogController`.

### 5. Controller processes the request
The matched controller method in `/app/Http/Controllers/BlogController.php` runs. It queries the database using Models to fetch the necessary data (posts, categories, etc.).

### 6. Models interact with the database
Models in `/app/Models` represent database tables. When the controller asks for posts, the Post model queries the database and returns the data as PHP objects.

### 7. View renders the response
The controller passes data to a Blade template in `/resources/views`. The template generates HTML by inserting the data into the layout and page-specific templates.

### 8. HTML returns to browser
The rendered HTML is sent back to the user's browser and displayed.

## Key Files and Their Purposes

### Configuration Files

**`.env`** — Environment variables specific to this server
- Database credentials (host, database name, username, password)
- Application URL and environment (production vs local)
- Cache and session drivers
- Stored in root directory, not version controlled (security)

**`composer.json`** — Declares all PHP package dependencies
- Lists required packages like Laravel, Tinker, etc.
- Specifies PHP version requirements
- Located in root directory

**`composer.lock`** — Locks exact versions of all installed packages
- Ensures consistency when deploying to servers
- Auto-generated by Composer, should be committed to version control
- Located in root directory

### Database Files

**`database/migrations/0001_01_01_000000_create_users_table.php`** — The master migration file
- Defines all database tables and their columns
- Includes users, posts, categories, comments, sessions, and caching tables
- Migrations are run once and tracked; Laravel knows which ones have executed
- When you run `php artisan migrate`, Laravel only runs migrations it hasn't seen before

### Model Files

**`app/Models/User.php`** — Represents a blog author
- Defines relationships to posts and comments
- Specifies which columns can be mass-assigned
- Hides sensitive columns like passwords from output

**`app/Models/Post.php`** — Represents a blog post
- Defines relationships to the author (User) and category
- Includes attributes like title, slug, content, status, and published_at timestamp

**`app/Models/Category.php`** — Represents a blog category
- Defines relationship to posts (a category has many posts)

**`app/Models/Comment.php`** — Represents a blog comment
- Defines relationships to the post and user who commented

### Controller File

**`app/Http/Controllers/BlogController.php`** — Handles all blog-related requests
- `index()` method — Fetches published posts and categories, renders the homepage
- `show()` method — Fetches a single post by slug, renders the individual post page
- `category()` method — Fetches posts in a specific category, renders the category page
- Uses Models to query the database and passes data to views

### Route File

**`routes/web.php`** — Maps URLs to controller methods
- `/` routes to `BlogController@index` (homepage)
- `/blog/{slug}` routes to `BlogController@show` (individual post)
- `/category/{slug}` routes to `BlogController@category` (category page)
- Routes named for easy reference in views

### View Files

**`resources/views/layouts/app.blade.php`** — Master layout template
- Contains HTML structure shared by all pages (header, navigation, footer)
- Uses `@yield('content')` to inject page-specific content
- Includes styling with Tailwind CSS and Font Awesome icons
- Defines the SLS logo and navigation bar

**`resources/views/blog/index.blade.php`** — Homepage template
- Extends the app layout
- Uses Blade syntax to loop through posts and categories
- Displays post excerpts with links to full posts
- Shows sidebar with search, categories dropdown, and archives

**`resources/views/blog/show.blade.php`** — Individual post template
- Extends the app layout
- Displays the full post content, author, and publication date
- Shows sidebar with post information and related posts

**`resources/views/blog/category.blade.php`** — Category page template
- Extends the app layout
- Displays all posts in a specific category
- Similar structure to homepage but filtered by category

## Database Structure

The application uses a MySQL database named `slslanguage_blog` (separate from the old blog database to prevent conflicts).

### Tables

**users** — Stores blog authors
- Contains email, password, name fields, and role/status designations

**posts** — Stores blog articles
- Contains title, slug (URL-friendly version of title), content, status (draft/published)
- References author_id (belongs to a user) and category_id (belongs to a category)
- Includes published_at timestamp to track when the post was published

**categories** — Stores blog post categories
- Contains name and slug for organization

**comments** — Stores reader comments on posts
- References post_id and user_id to track who commented on which post
- Includes status field to moderate comments (pending/approved)

**sessions** — Stores user session data
- Laravel uses this to track logged-in users

**migrations** — Tracks which migrations have run
- Laravel uses this to know which migrations to skip when you run `php artisan migrate` again

## Relationships Between Models

**User has many Posts** — An author can write multiple blog posts

**Post belongs to User** — Every post has one author

**Post belongs to Category** — Every post is in one category

**Category has many Posts** — A category contains multiple posts

**Post has many Comments** — A post can have multiple reader comments

**Comment belongs to Post** — Every comment is on a specific post

**Comment belongs to User** — Every comment is by a specific user

**User has many Comments** — A user can make multiple comments

## How Data Flows in a Request

### Example: Viewing the homepage (`/`)

1. Browser requests `https://blog.slslanguage.com/`
2. `routes/web.php` matches `/` to `BlogController@index`
3. `BlogController::index()` runs:
   - Uses Post model to query for published posts (ordered by newest)
   - Uses Category model to query for all categories
   - Passes both datasets to the `blog/index` view
4. `resources/views/blog/index.blade.php` renders:
   - Extends `layouts/app.blade.php` for header/footer
   - Loops through posts, displaying title, author, excerpt, publish date
   - Loops through categories in sidebar dropdown
5. Final HTML sent to browser

### Example: Viewing a single post (`/blog/my-post-title`)

1. Browser requests `https://blog.slslanguage.com/blog/my-post-title`
2. `routes/web.php` matches `/blog/{slug}` to `BlogController@show`
3. `BlogController::show('my-post-title')` runs:
   - Uses Post model to find post with that slug
   - Uses Post model relationships to load the author and category
   - Queries for related posts in the same category
   - Passes post and related posts to the `blog/show` view
4. `resources/views/blog/show.blade.php` renders:
   - Extends `layouts/app.blade.php`
   - Displays full post content, author name, publication date
   - Shows sidebar with post metadata and related post links
5. Final HTML sent to browser

## Separation of Concerns

This application follows the MVC (Model-View-Controller) pattern:

**Models** — Handle data and database interactions
- Located in `app/Models/`
- Know how to query the database
- Define relationships between tables
- Do not know about HTML or user requests

**Views** — Handle presentation and display
- Located in `resources/views/`
- Contain HTML and Blade templating syntax
- Display data passed from controllers
- Do not query the database directly

**Controllers** — Handle application logic and request flow
- Located in `app/Http/Controllers/`
- Receive user requests
- Use models to fetch data
- Pass data to views
- Know about both models and views but keep logic separate

This separation means:
- Designers can edit views without touching business logic
- Database changes only affect models
- Controllers stay focused on orchestrating requests
- Code is more testable and maintainable

## Configuration and Setup

### Environment-Specific Settings

The `.env` file contains server-specific settings that change between local development and production:

- **Database credentials** — Points to the correct database on each server
- **App URL** — Tells Laravel the application's web address
- **App environment** — Indicates whether this is production (stricter) or local (more verbose errors)
- **Cache driver** — How cached data is stored (file, database, Redis, etc.)

### Migrations and Database Setup

When the application first runs on a server:

1. The `/database/migrations/` folder contains the structure definition
2. Running `php artisan migrate` creates all tables in the database
3. Laravel tracks which migrations have run in the `migrations` table
4. Future runs only execute new migrations, preventing duplicate table creation
5. This allows the team to add new tables/columns by adding new migration files

## Deployment Process

When moving code from local development to the cPanel server:

1. Upload all files from the local `/app`, `/routes`, `/resources`, `/database`, `/config`, `/public` folders
2. Update the `.env` file with production database credentials
3. Run `composer install` on the server to install PHP dependencies from `composer.lock`
4. Run `php artisan migrate` to create database tables
5. Run `php artisan config:cache` to speed up configuration loading
6. Run `php artisan route:cache` to speed up route matching

The `/vendor` folder (third-party packages) is NOT uploaded — it's recreated from `composer.lock` using Composer on the server.

## Key Takeaways

- **Models** are where data lives (database interactions)
- **Controllers** are where logic lives (business rules and request handling)
- **Views** are where presentation lives (HTML output)
- **Routes** connect URLs to controllers
- **Migrations** define the database structure once and track changes
- **Models have relationships** to express how database tables connect
- The **public folder** is the only part accessible from the web
- The **.env file** contains secrets and server-specific settings
- **Composer** manages PHP dependencies across different servers

This architecture makes the blog maintainable, scalable, and separated from the main website.